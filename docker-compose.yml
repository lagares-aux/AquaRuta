version: "3.9"

services:
  db:
    image: supabase/postgres:15.1.0.89
    container_name: aquaruta-db
    restart: unless-stopped
    env_file:
      - .env
    ports:
      - "5432:5432"
    volumes:
      - db-data:/var/lib/postgresql/data

  auth:
    image: supabase/gotrue:v2.143.2
    container_name: aquaruta-auth
    restart: unless-stopped
    depends_on:
      - db
    env_file:
      - .env
    ports:
      - "9999:9999"

  rest:
    image: postgrest/postgrest:v12.2.3
    container_name: aquaruta-rest
    restart: unless-stopped
    depends_on:
      - db
    env_file:
      - .env
    ports:
      - "3001:3000"

  realtime:
    image: supabase/realtime:v2.25.55
    container_name: aquaruta-realtime
    restart: unless-stopped
    depends_on:
      - db
    env_file:
      - .env
    ports:
      - "4000:4000"

  storage:
    image: supabase/storage-api:v0.42.8
    container_name: aquaruta-storage
    restart: unless-stopped
    depends_on:
      - db
      - auth
    env_file:
      - .env
    ports:
      - "5000:5000"

  meta:
    image: supabase/postgres-meta:v0.80.0
    container_name: aquaruta-meta
    restart: unless-stopped
    depends_on:
      - db
    env_file:
      - .env
    ports:
      - "8080:8080"

  studio:
    image: supabase/studio:20250107-4b06c71
    container_name: aquaruta-studio
    restart: unless-stopped
    depends_on:
      - db
      - auth
      - rest
      - storage
      - meta
    env_file:
      - .env
    ports:
      - "3000:3000"

volumes:
  db-data:
    driver: local
