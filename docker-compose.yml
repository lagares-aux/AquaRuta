services:
  db:
    image: supabase/postgres:15.1.1.2
    container_name: aquaruta-db
    restart: unless-stopped
    env_file:
      - .env
    ports:
      - "5432:5432"
    volumes:
      - db-data:/var/lib/postgresql/data

  auth:
    image: supabase/gotrue:v2.158.1
    container_name: aquaruta-auth
    restart: unless-stopped
    depends_on:
      - db
    env_file:
      - .env
    ports:
      - "9999:9999"

  rest:
    image: postgrest/postgrest:v12.2.0
    container_name: aquaruta-rest
    restart: unless-stopped
    depends_on:
      - db
    env_file:
      - .env
    ports:
      - "3001:3000"

  realtime:
    image: supabase/realtime:v2.30.23
    container_name: aquaruta-realtime
    restart: unless-stopped
    depends_on:
      - db
    env_file:
      - .env
    ports:
      - "4000:4000"

  storage:
    image: supabase/storage-api:v1.11.13
    container_name: aquaruta-storage
    restart: unless-stopped
    depends_on:
      - db
      - auth
    env_file:
      - .env
    ports:
      - "5000:5000"

  imgproxy:
    image: darthsim/imgproxy:v3.8.0
    container_name: aquaruta-imgproxy
    restart: unless-stopped
    depends_on:
      - storage
    env_file:
      - .env
    ports:
      - "8081:8080"

  meta:
    image: supabase/postgres-meta:v0.83.2
    container_name: aquaruta-meta
    restart: unless-stopped
    depends_on:
      - db
    env_file:
      - .env
    ports:
      - "8080:8080"

  studio:
    image: supabase/studio:20241202-b258277
    container_name: aquaruta-studio
    restart: unless-stopped
    depends_on:
      - db
      - auth
      - rest
      - storage
      - meta
    env_file:
      - .env
    ports:
      - "3000:3000"

volumes:
  db-data:
    driver: local